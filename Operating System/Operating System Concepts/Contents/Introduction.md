# 서론

> \- 컴퓨터 시스템의 일반적인 구성과 인터럽트의 역할
  \- 현대 다중 처리기 컴퓨터 시스템의 구성요소
  \- 사용자 모드에서 커널 모드로의 전환
  \- 다양한 컴퓨팅 환경에서 운영체제의 사용 방식
  \- 공개 소스 운영체제의 예


**Operating System(운영체제)**
하드웨어를 관리하는 소프트웨어    
응용 프로그램을 위한 기반을 제공하며 컴퓨터 사용자와 컴퓨터 하드웨어 사이의 중재자 역할 수행

운영체제의 역할을 학습하기 위해서는 먼저 컴퓨터 하드웨어의 구성과 구조를 이해하는 것이 중요하다.

운영체제는 덩치가 크고 복잡하기 때문에 부분별로 생성 되어야 하고, 이 하나의 부분은 전체 시스템 윤곽에 잘 맞는 일부여야 한다.



# 차례
[1.1 운영체제가 할 일](#what-operating-system-do)          
[1.1.1 사용자 관점](#user-view)            
[1.1.2 시스템 관점](#system-view)                 
[1.1.3 운영체제의 정의](#operating-system-definitions)              

[1.2 컴퓨터 시스템의 구성](#computer-system-organization)             
[1.2.1 인터럽트](#interrupts)            
[1.2.2 저장장치 구조](#storage-structure)             
[1.2.3 입출력 구조](#io-structure)              

[1.3 컴퓨터 시스템의 구조](#computer-system-architecture)             
[1.3.1 단일 처리기 시스템](#single-processor-systems)           
[1.3.2 다중 처리기 시스템](#multiprocessor-systems)             
[1.3.3 클러스터형 시스템](#clustered-systems)             

[1.4 운영체제의 작동](#Operating-System-Operations)             
[1.4.1 다중 프로그래밍과 다중 태스킹](#multiprogramming-and-multitasking)              
[1.4.2 이중모드와 다중모드 운용](#dualmode-and-multimode-operation)             
[1.4.3 타이머](#timer)             
           
[1.5 자원 관리](#Resource Management)

[1.6 보안과 보안](#Security and Protection)

[1.7 가상화](#Virtulization)

[1.8 분산 시스템](#Distributed-Systems)

[1.9 커널 자료구조](#Kernel_Data-Structures)

[1.10 계산 환경](#Computing Environments)

[1.11 무료 및 공개 소스 운영체제](#Free-and-OpenSource-Operating-Systems)



# What Operating System Do

운영체제가 수행하는 역할을 알아보기 전에 컴퓨터 시스템에 대한 논의부터 진행해야 한다. 컴퓨터 시스템은 4가지 구성요소인 **하드웨어, 운영체제, 응용 프로그램, 사용자**로 구분할 수 있다.

**하드웨어**            
> CPU(중앙 처리 장치), 메모리, I/O(입출력) 장치로 구성                        
  기본 계산용 자원 제공          

**응용 프로그램**                    
> 사용자의 계산 문제를 해결하기 위해 자원이 어떻게 사용될지 정의           
  위드 프로세서, 스프레드시트, 컴파일러, 웹 브라우저 등        

**운영체제**           
> 다양한 사용자를 위해 다양한 응용 프로그램 간의 하드웨어 사용을 제어 및 조정    
  자체로는 유용한 작업을 수행할 수 없음
  다른 프로그램이 유용한 작업을 할 수 있는 **환경** 제공
  
운영체제의 역할을 완전히 이해하기 위해서는 사용자와 시스템의 두 관점에서 살펴봐야 한다.

## User View

컴퓨터에 대한 사용자의 관점은 사용되는 인터페이스에 따라 달라진다.

*모니터, 키보드, 마우스로 구성된 PC*
> 한 사용자가 자원을 독점하도록 설계        
  운영체제 : 사용의 용이성을 위해 설계되고, 자원의 이용은 신경쓰지 않는다.
  
*가전제품 내 내장형 컴퓨터*
> 운영체제 : 사용자의 개입 없이 작동하도록 설계

## System View

컴퓨터의 관점에서 운영체제는 하드웨어와 가장 밀접하게 연관된 프로그램이다.

**운영체제**
> **Resource Allocator(자원 할당자)**         
  제 해결을 위해 요구되는 여러 자원(CPU 시간, 메모리 공간, 저장장치 공간 등)을 할당할지 결정       
  **Control Program(제어 프로그램)**         
  컴퓨터의 부적절한 사용을 방지하기 위해 사용자 프로그램의 수행을 저지

## Operating System Definitions

컴퓨터의 설계와 용도에 따라 수행해야할 역할과 기능이 달라지기 때문에 운영체제가 많은 역할과 기능을 수행해야 한다.

초기 컴퓨터       
목적 : 군사용, 정부 업무 등의 고정 목적 시스템          
특징 : 범용의 다기능 대형 컴퓨터로 발전 및 운영체제 등장

1960년대 무어의 법칙이 집적회로의 트랜지스터 수가 18개월마다 배로 늘어날 것으로 예측           
컴퓨터는 기능이 확대되고 크기가 작아지고, 용도가 다양화 되면서 다양한 운영체제 등장

**컴퓨터 시스템**의 기본 목표는 프로그램을 실행하고 사용자 문제를 쉽게 해결할 수 있게 만드는 것이다. 컴퓨터 **하드웨어**는 이러한 목표를 가지고 구성되지만 하드웨어 만으로는 사용하기가 쉽지 않아 **응용 프로그램**이 개발된다. 이러한 프로그램에는 특정 공통 작업이 필요하면서 자원을 제어하고 할당하는 **운영체제**가 개발된다.

따라서 운영체제는 적합한 정의나 운영체제에 포함되는 요소의 보편적인 정의가 없다. 운영체제는 단지 유용한 컴퓨팅 시스템을 만들기 위한 합리적인 방법을 제공하는 방식이다.

운영체제는 커널과 시스템 프로그램으로 구성된다. 종종 미들웨어를 포함하는 경우도 존재한다.
> 커널 : 컴퓨터에서 항상 실행되는 프로그램
  미들웨어 : 응요 프로그램 개발자에게 추가 서비스를 제공하는 소프트웨어 프레임워크
  
```markdown
운영체제
커널 + 미들웨어 프레임워크 + 시스템 프로그램
(항상 실행) + (응용 프로그램 개발 용이) + (시스템 관리)
```

# computer-system-organization

현대의 범용 컴퓨터 시스템은 하나 이상의 CPU와 구성요소, 공유 메모리 사이의 엑세스를 제공하는 공통 **버스**를 통해 연결된 여러 장치 컨트롤러로 구성된다. 각 장치 컨트롤러는 특정 유형의 장치를 담당하지만, 컨트롤러에 따라 2개 이상의 장치가 연결될 수 있다. 

**장치 컨트롤러**        
> 일부 로컬 버퍼 저장소와 특수 목적 레지스터 집합 유지, 관리         
  제어하는 주변 장치와 로컬 버퍼 저장소간 데이터 이동    

일반적으로 운영체제에는 각 장치 컨트롤러마다 장치 드라이버가 있다.

**장치 드라이버**
> 장치 컨트롤러의 작동을 잘 알고, 운영체제와 장치 사이 인터페이스 역할

CPU와 장치 컨트롤러는 메모리에 대한 엑세스를 동기화한다. 이러한 시스템 작동방식의 3가지 주요 측면에 대해 살펴보자

## interrupts

일반적인 입출력을 수행하는 컴퓨터 작업은 아래와 같이 실행된다.
```markdown
1. 장치 드라이버는 장치 컨트롤러의 적절한 레지스터 값 적재
2. 장치 컨트롤러는 레지스터 내용을 검사해 수행할 작업 결정
3. 컨트롤러는 장치에서 로컬 버퍼로 데이터 전송 시작
4. 데이터 전송이 완료되면 장치 컨트롤러는 장치 드라이버에게 작업 완료 알림
5. 장치 드라이버는 제어권을 넘기거나 상태 정보를 반환
```

이때 컨트롤러는 **인터럽트**를 통해 장치 드라이버에게 작업을 완료했다는 사실을 알린다. 

### Overview

하드웨어는 어느 순간이든 시스템 버스를 통해 CPU의 신호를 보내 인터럽트를 발생시킬 수 있다. 따라서 인터럽트는 운영체제와 하드웨어의 상호 작용 방식의 핵심 부분이다.

CPU 인터럽트 발생
```markdown
1. CPU가 하던 작업을 중단하고 고정된 위치로 실행을 옮김
2. 인터럽트 서비스 루틴 시작(고정된 위치에 인터럽트 서비스 루틴 저장되어 있음)
3. 인터럽트 서비스 루틴 종료 시, DPU는 인터럽트 되었던 연산 재개
```

인터럽트는 컴퓨터 구조의 중요한 부분이기 때문에 각 컴퓨터 설계는 자신의 인터럽트 메커니즘을 가지고 있으며 몇 가지 기능은 공통으로 적절한 서비스 루틴으로 적절한 제어를 전달한다. 

인터럽트 루틴은 인터럽트 고유의 핸들러를 호출한다. 인터럽트는 매우 빈번하게 발생하기 때문에 이를 빠르게 처리되어야 한다. 필요한 속도를 위해 인터럽트 루틴에 대한 포인터들의 테이블을 대신 이용할 수 있어야 한다.

일반적으로 포인터들의 테이블은 하위 메모리에 저장된다. 이 위치에는 여러 장치에 대한 인터럽트 서비스 루틴의 주소가 들어 있다. 인터럽트가 요청되면, 인터럽트를 유발한 장치를 위한 인터럽트 서비스 루틴을 제공하기 위해 인터럽트 벡터(주소 배열)가 인터럽트 요청과 함께 주어진 고유 장치 번호로 색인된다. 

인터럽트 구조는 인터럽트 된 모든 정보를 저장해야 인터럽트를 처리한 후 이 정보를 복원할 수 있다. 

```markdown
1. 인터럽트 루틴이 처리기의 상태를 변경해야 한다면, 인터럽트 루틴은 현재 상태를 저장
2. 인터럽트를 서비스한 후 저장되어 있던 복귀 주소를 프로그램 카운터에 적재
3. 인터럽트에 의해 중단 되었던 연산 다시 실행
```

### Implementation

기본 인터럽트 메커니즘의 작동
```markdown
1. CPU 하드웨어는 **인터럽트 요청 라인**으로 명령어의 실행 완료를 감지
2. 실행 완료를 감지하면 인터럽트 번호를 읽고 이 번호를 인터럽트 벡터의 인덱스로 사용
3. 인덱스에 따라 **인터럽트 핸들러 루틴**으로 점프
4. 해당 인텍스와 관련된 주소에서 실행 시작
5. 인터럽트 처리기는 작업 중 변경될 상태를 저장, 인터럽트 원인 확인, 필요한 처리, 상태 복원 수행
6. **return_from-interrupt** 명령어 실행
7. CPU를 인터럽트 발생 전 실행 상태로 되돌린다.
7.1. 장치 컨트롤러가 인터럽트 요청 라인에 신호를 선언하여 인터럽트 **발생(raise)**
7.2. CPU가 인터럽트를 **포착(catch)** 하여 인터럽트 핸들러로 **디스패치(dispatch)**
7.3 핸들러는 장치를 서비스하여 인터럽트 **지움(clear)**
```

**인터럽트 컨트롤러 하드웨어**는 보다 정교한 인터럽트 처리 기능을 제공한다
> \-중요한 처리 중 인터럽트 연기          
  \-장치의 적절한 인터럽트 핸들러로 효율적으로 디스패치               
  \-우선순위에 따라 인터럽트를 구별               
  \-긴급도로 대응할 수 있도록 다단계 인터럽트 구축            

대부분의 CPU에는 2개의 인터럽트 요청 라인이 있다.
> **마스킹 불가능 인터럽트** : 메모리 오류와 같은 이벤트를 위해 예약하기 위해 사용
  **바스킹 가능 인터럽트** : 장치 컨트롤러가 서비스를 요청하기 위해 사용

벡터 방식 인터럽트 기법의 목적은 서비스가 필요한 장치를 결정하기 위해 하나의 인터럽트 핸들러가 가능한 모든 인터럽트 소스를 검색할 필요를 줄이는 것이다. 그러나 실제 컴퓨터에는 인터럽트 벡터의 주소 개수보다 많은 장치(인터럽트 처리기)가 있다. 따라서 **인터럽트 체인**을 사용한다.

**인터럽트 체인**
큰 크기의 인터럽트 테이블의 오버헤드와 하나의 인터럽트 핸들러로 디스패치 하는 비효율성의 절충안
```markdown
1. 인터럽트 벡터의 각 원소는 인터럽트 핸들러 리스트의 헤드를 가리킨다.
2. 인터럽트가 발생하면 요청을 처리할 수 있는 핸들러가 발견될 때까지 상응하는 리스트의 핸들러가 하나씩 호출

인터럽트 기법은 인터럽트 **우선순위 레벨**을 구현한다. 이러한 레벨을 통해 CPU는 모든 인터럽트를 마스킹하지 않고도 우선순위가 낮은 인터럽트 처리를 연기할 수 있고, 우선순위가 높은 인터럽트를 선점할 수 있다. 

```markdown
**인터럽트**         
> 최신 운엥체제에서 비동기 이벤트를 처리하기 위해 사용            
  장치 컨트롤러 및 하드웨어 오류로 인해 발생             
  가장 긴급한 작업을 먼저 처리하기 위해 우선순위 시스템 사용             
  시스템 성능을 좋게 하려면 효율적인 인터럽트 처리가 필요           

```


## storage-structure
## io-structure

# computer-system-architecture
## single-processor-systems
## multiprocessor-systems
## clustered-systems

# Operating-System-Operations
## multiprogramming-and-multitasking
## dualmode-and-multimode-operation
## timer
